{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Zak Lambert\\\\Documents\\\\GitHub\\\\tbc-sim\\\\src\\\\pages\\\\spells\\\\HealingContainer.jsx\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Field } from 'redux-form';\nimport _ from 'lodash';\nimport HealingView from './HealingView';\nimport '../style.css';\n\nclass HealingContainer extends Component {\n  applyTalents({\n    spell,\n    rank,\n    character,\n    target\n  }, talents) {\n    const modifiedSpell = Object.assign({}, spell);\n    const modifiedRank = Object.assign({}, rank);\n    const modifiedCharacter = Object.assign({}, character);\n    const modifiedTarget = Object.assign({}, target);\n\n    _.forOwn(talents, value => {\n      if (character[value.field]) {\n        value.effect({\n          spell,\n          rank,\n          modifiedSpell: modifiedSpell,\n          modifiedRank: modifiedRank,\n          character: modifiedCharacter,\n          target: modifiedTarget\n        });\n      }\n    });\n\n    return {\n      modifiedSpell,\n      modifiedRank,\n      modifiedCharacter,\n      modifiedTarget,\n      spell,\n      rank,\n      character,\n      target\n    };\n  }\n\n  computeSpellDetails({\n    modifiedSpell,\n    modifiedRank,\n    modifiedCharacter,\n    target,\n    spell,\n    rank\n  }) {\n    const lowLevelPenalty = 1 - (20 - Math.min(rank.level, 20)) * 0.0375;\n    const coefficient = Math.min(rank.castTime, 3.5) / 3.5 * lowLevelPenalty;\n    const directCoefficient = spell.coefficient ? spell.coefficient * modifiedSpell.bonusDirect * lowLevelPenalty : coefficient * modifiedSpell.bonusDirect;\n    const hotCoefficient = spell.hotCoefficient ? spell.hotCoefficient * modifiedSpell.bonusHotCo * lowLevelPenalty : Math.min((modifiedRank.duration || 15) / 15, 1) * lowLevelPenalty; // * modifiedSpell.bonusHotCo;\n\n    const totalCrit = Math.min(+modifiedCharacter.crit, 100);\n    const mana = modifiedRank.mana;\n    const castTime = Math.max(modifiedRank.castTime, 1.5);\n    const numberOfTicks = modifiedRank.duration / 3.0;\n    const modifiedNumberOfTicks = modifiedRank.duration / 3.0;\n    const bonusHot = modifiedSpell.hot ? hotCoefficient * +modifiedCharacter.healing : 0.0;\n    const baseHotTick = modifiedRank.hotTick || 0;\n    const bonusHotTick = bonusHot / numberOfTicks;\n    const totalBaseHot = baseHotTick * modifiedNumberOfTicks;\n    const totalBonusHot = bonusHotTick * modifiedNumberOfTicks;\n    const totalHot = totalBaseHot + totalBonusHot || 0.0;\n    const hotTick = totalHot / modifiedNumberOfTicks;\n    const baseAverage = ((modifiedRank.min || 0) + (modifiedRank.max || 0)) / 2;\n    const bonusHeal = modifiedSpell.direct ? directCoefficient * +modifiedCharacter.healing : 0.0;\n    const averageCritBonus = (baseAverage + bonusHeal) / 2 * (totalCrit / 100);\n    const totalDirect = baseAverage + bonusHeal + averageCritBonus;\n    const totalAverage = totalDirect + totalHot;\n    const manaEfficiency = totalAverage / mana;\n    const healingPerSecond = totalAverage / castTime;\n    const manaPerSecond = 5 * mana * (1 / castTime);\n    const rating = (healingPerSecond / 10 + manaEfficiency * 10) * 20;\n    return {\n      rank: rank.rank,\n      rankDescription: \"Rank \".concat(rank.rank),\n      mana: mana.toFixed(2),\n      mp5: manaPerSecond.toFixed(2),\n      castTime,\n      base: baseAverage.toFixed(2),\n      hot: totalBaseHot,\n      hotTick,\n      bonus: bonusHeal.toFixed(2),\n      bonusHot: totalBonusHot,\n      crit: averageCritBonus.toFixed(2),\n      total: totalAverage.toFixed(2),\n      hps: healingPerSecond.toFixed(2),\n      efficiency: +manaEfficiency.toFixed(2),\n      rating,\n      coefficient\n    };\n  }\n\n  generateHealingTable(formValues = {}) {\n    return _.map(this.props.spell.ranks, rank => {\n      return this.computeSpellDetails(this.applyTalents({\n        spell: this.props.spell,\n        rank,\n        character: formValues,\n        target: {}\n      }, this.props.talents));\n    });\n  }\n\n  render() {\n    const _this$applyTalents = this.applyTalents({\n      spell: this.props.spell,\n      rank: this.props.spell.ranks[0],\n      character: this.props.formValues || {},\n      target: {}\n    }, this.props.talents),\n          modifiedSpell = _this$applyTalents.modifiedSpell;\n\n    return React.createElement(HealingView, {\n      spellName: modifiedSpell.name,\n      spell: modifiedSpell,\n      healingTable: this.generateHealingTable(this.props.formValues),\n      talents: this.props.talents,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, \"Character\"), React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"large-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"healing\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, \"Healing\", React.createElement(Field, {\n      name: \"healing\",\n      component: \"input\",\n      type: \"number\",\n      min: \"0\",\n      max: \"9999\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"large-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"crit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"Crit %\", React.createElement(Field, {\n      name: \"crit\",\n      component: \"input\",\n      type: \"number\",\n      min: \"0\",\n      max: \"100\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"large-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"spirit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, \"Spirit\", React.createElement(Field, {\n      name: \"spirit\",\n      component: \"input\",\n      type: \"number\",\n      min: \"0\",\n      max: \"999\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"large-4 columns\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default connect()(HealingContainer);","map":{"version":3,"sources":["C:\\Users\\Zak Lambert\\Documents\\GitHub\\tbc-sim\\src\\pages\\spells\\HealingContainer.jsx"],"names":["React","Component","connect","Field","_","HealingView","HealingContainer","applyTalents","spell","rank","character","target","talents","modifiedSpell","Object","assign","modifiedRank","modifiedCharacter","modifiedTarget","forOwn","value","field","effect","computeSpellDetails","lowLevelPenalty","Math","min","level","coefficient","castTime","directCoefficient","bonusDirect","hotCoefficient","bonusHotCo","duration","totalCrit","crit","mana","max","numberOfTicks","modifiedNumberOfTicks","bonusHot","hot","healing","baseHotTick","hotTick","bonusHotTick","totalBaseHot","totalBonusHot","totalHot","baseAverage","bonusHeal","direct","averageCritBonus","totalDirect","totalAverage","manaEfficiency","healingPerSecond","manaPerSecond","rating","rankDescription","toFixed","mp5","base","bonus","total","hps","efficiency","generateHealingTable","formValues","map","props","ranks","render","name"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Field } from 'redux-form';\r\nimport _ from 'lodash';\r\nimport HealingView from './HealingView';\r\nimport '../style.css';\r\n\r\nclass HealingContainer extends Component {\r\n\r\n  applyTalents({ spell, rank, character, target }, talents) {\r\n    const modifiedSpell = Object.assign({}, spell);\r\n    const modifiedRank = Object.assign({}, rank);\r\n    const modifiedCharacter = Object.assign({}, character);\r\n    const modifiedTarget = Object.assign({}, target);\r\n\r\n    _.forOwn(talents, (value) => {\r\n      if (character[value.field]) {\r\n        value.effect({\r\n          spell,\r\n          rank,\r\n          modifiedSpell: modifiedSpell,\r\n          modifiedRank: modifiedRank,\r\n          character: modifiedCharacter,\r\n          target: modifiedTarget,\r\n        });\r\n      }\r\n    });\r\n    return {\r\n      modifiedSpell,\r\n      modifiedRank,\r\n      modifiedCharacter,\r\n      modifiedTarget,\r\n      spell,\r\n      rank,\r\n      character,\r\n      target,\r\n    };\r\n  }\r\n\r\n  computeSpellDetails({ modifiedSpell, modifiedRank, modifiedCharacter, target, spell, rank }) {\r\n\r\n    const lowLevelPenalty = (1 - ((20 - Math.min(rank.level, 20)) * 0.0375));\r\n    const coefficient = ((Math.min(rank.castTime, 3.5) / 3.5) * lowLevelPenalty);\r\n    const directCoefficient = spell.coefficient ? (spell.coefficient * modifiedSpell.bonusDirect * lowLevelPenalty) : coefficient * modifiedSpell.bonusDirect;\r\n    const hotCoefficient = spell.hotCoefficient ? (spell.hotCoefficient * modifiedSpell.bonusHotCo * lowLevelPenalty) : Math.min(((modifiedRank.duration || 15) / 15), 1) * lowLevelPenalty;// * modifiedSpell.bonusHotCo;\r\n\r\n    const totalCrit = Math.min(+modifiedCharacter.crit, 100);\r\n\r\n    const mana = modifiedRank.mana;\r\n    const castTime = Math.max(modifiedRank.castTime, 1.5);\r\n    const numberOfTicks = modifiedRank.duration / 3.0;\r\n    const modifiedNumberOfTicks = modifiedRank.duration / 3.0;\r\n    const bonusHot = modifiedSpell.hot ? hotCoefficient * +modifiedCharacter.healing : 0.0;\r\n    const baseHotTick  = (modifiedRank.hotTick || 0);\r\n    const bonusHotTick = (bonusHot / numberOfTicks);\r\n    const totalBaseHot = baseHotTick * modifiedNumberOfTicks;\r\n    const totalBonusHot = bonusHotTick * modifiedNumberOfTicks;\r\n    const totalHot = totalBaseHot + totalBonusHot || 0.0;\r\n    const hotTick = totalHot / modifiedNumberOfTicks;\r\n    const baseAverage = ((modifiedRank.min || 0) + (modifiedRank.max || 0)) / 2;\r\n    const bonusHeal = modifiedSpell.direct ? directCoefficient * +modifiedCharacter.healing : 0.0;\r\n    const averageCritBonus = ((baseAverage + bonusHeal) / 2) * (totalCrit / 100);\r\n    const totalDirect = (baseAverage + bonusHeal + averageCritBonus);\r\n    const totalAverage = (totalDirect + totalHot);\r\n    const manaEfficiency = totalAverage / mana;\r\n    const healingPerSecond = totalAverage / castTime;\r\n    const manaPerSecond = 5 * mana * (1 / castTime);\r\n    const rating = ((healingPerSecond / 10) + (manaEfficiency * 10)) * 20;\r\n\r\n    return {\r\n      rank: rank.rank,\r\n      rankDescription: `Rank ${ rank.rank }`,\r\n      mana: mana.toFixed(2),\r\n      mp5: manaPerSecond.toFixed(2),\r\n      castTime,\r\n      base: baseAverage.toFixed(2),\r\n      hot: totalBaseHot,\r\n      hotTick,\r\n      bonus: bonusHeal.toFixed(2),\r\n      bonusHot: totalBonusHot,\r\n      crit: averageCritBonus.toFixed(2),\r\n      total: totalAverage.toFixed(2),\r\n      hps: healingPerSecond.toFixed(2),\r\n      efficiency: +(manaEfficiency).toFixed(2),\r\n      rating,\r\n      coefficient,\r\n    };\r\n  }\r\n\r\n  generateHealingTable(formValues = {}) {\r\n    return _.map(this.props.spell.ranks, rank => {\r\n      return this.computeSpellDetails(\r\n        this.applyTalents({\r\n          spell: this.props.spell,\r\n          rank,\r\n          character: formValues,\r\n          target: {},\r\n        }, this.props.talents));\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { modifiedSpell } = this.applyTalents({\r\n      spell: this.props.spell,\r\n      rank: this.props.spell.ranks[0],\r\n      character: this.props.formValues || {},\r\n      target: {},\r\n    }, this.props.talents);\r\n    return (\r\n      <HealingView\r\n        spellName={ modifiedSpell.name }\r\n        spell={ modifiedSpell }\r\n        healingTable={ this.generateHealingTable(this.props.formValues) }\r\n        talents={ this.props.talents }\r\n      >\r\n        <h3>Character</h3>\r\n        <div className='row'>\r\n          <div className='large-4 columns'>\r\n            <label htmlFor='healing'>Healing\r\n              <Field name='healing' component='input' type='number' min='0' max='9999' />\r\n            </label>\r\n          </div>\r\n          <div className='large-4 columns'>\r\n            <label htmlFor='crit'>Crit %\r\n              <Field name='crit' component='input' type='number' min='0' max='100' />\r\n            </label>\r\n          </div>\r\n          <div className='large-4 columns'>\r\n            <label htmlFor='spirit'>Spirit\r\n              <Field name='spirit' component='input' type='number' min='0' max='999' />\r\n            </label>\r\n          </div>\r\n          <div className='large-4 columns' />\r\n        </div>\r\n      </HealingView>\r\n    );\r\n  }\r\n}\r\nexport default connect()(HealingContainer);\r\n"]},"metadata":{},"sourceType":"module"}